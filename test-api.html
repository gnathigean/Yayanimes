<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Teste API - YayAnimes</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Courier New", monospace;
        background: #0f172a;
        color: white;
        padding: 20px;
        max-width: 1400px;
        margin: 0 auto;
      }

      h1 {
        text-align: center;
        margin-bottom: 30px;
        color: #667eea;
      }

      .status-bar {
        background: #1e293b;
        padding: 15px;
        border-radius: 8px;
        margin-bottom: 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .status {
        padding: 8px 16px;
        border-radius: 6px;
        font-weight: bold;
      }

      .status.success {
        background: #10b981;
        color: white;
      }
      .status.error {
        background: #ef4444;
        color: white;
      }
      .status.warning {
        background: #f59e0b;
        color: white;
      }
      .status.info {
        background: #3b82f6;
        color: white;
      }

      .controls {
        background: #1e293b;
        padding: 20px;
        border-radius: 8px;
        margin-bottom: 20px;
      }

      .controls h2 {
        margin-bottom: 15px;
        color: #667eea;
      }

      .button-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 10px;
      }

      button {
        background: #667eea;
        color: white;
        border: none;
        padding: 12px 20px;
        border-radius: 6px;
        cursor: pointer;
        font-size: 14px;
        font-weight: 600;
        transition: all 0.3s;
      }

      button:hover {
        background: #5568d3;
        transform: translateY(-2px);
      }

      button:active {
        transform: translateY(0);
      }

      .output-section {
        background: #1e293b;
        padding: 20px;
        border-radius: 8px;
      }

      .output-section h2 {
        margin-bottom: 15px;
        color: #667eea;
      }

      pre {
        background: #0f172a;
        padding: 15px;
        border-radius: 8px;
        overflow-x: auto;
        max-height: 600px;
        overflow-y: auto;
        font-size: 12px;
        line-height: 1.5;
        border: 2px solid #334155;
      }

      .endpoint-list {
        background: #1e293b;
        padding: 20px;
        border-radius: 8px;
        margin-bottom: 20px;
      }

      .endpoint-list h2 {
        margin-bottom: 15px;
        color: #667eea;
      }

      .endpoint-list ul {
        list-style: none;
      }

      .endpoint-list li {
        padding: 8px 0;
        border-bottom: 1px solid #334155;
        font-family: monospace;
        font-size: 13px;
        color: #9ca3af;
      }

      .endpoint-list li:last-child {
        border-bottom: none;
      }

      ::-webkit-scrollbar {
        width: 10px;
        height: 10px;
      }

      ::-webkit-scrollbar-track {
        background: #1e293b;
      }

      ::-webkit-scrollbar-thumb {
        background: #667eea;
        border-radius: 5px;
      }

      ::-webkit-scrollbar-thumb:hover {
        background: #5568d3;
      }
    </style>
  </head>
  <body>
    <h1>üß™ Teste da API YayAnimes</h1>

    <div class="status-bar">
      <div>
        <strong>Status da API:</strong>
        <span id="api-status" class="status warning">Verificando...</span>
      </div>
      <div>
        <strong>Base URL:</strong>
        <code style="color: #667eea"
          >https://yayapi-delta.vercel.app/api/v2/hianime</code
        >
      </div>
    </div>

    <div class="endpoint-list">
      <h2>üìã Endpoints Dispon√≠veis</h2>
      <ul>
        <li>‚úÖ /home - Homepage com todas as se√ß√µes</li>
        <li>‚úÖ /search?q={query} - Busca de animes</li>
        <li>‚úÖ /search/suggestion?q={query} - Sugest√µes de busca</li>
        <li>‚úÖ /anime/{id} - Informa√ß√µes do anime</li>
        <li>‚úÖ /anime/{id}/episodes - Lista de epis√≥dios</li>
        <li>
          ‚úÖ /episode/servers?animeEpisodeId={id} - Servidores dispon√≠veis
        </li>
        <li>
          ‚úÖ
          /episode/sources?animeEpisodeId={id}&server={server}&category={sub|dub|raw}
          - Links de streaming
        </li>
        <li>‚úÖ /genre/{name} - Animes por g√™nero</li>
        <li>‚úÖ /category/{name} - Animes por categoria</li>
        <li>‚úÖ /schedule - Cronograma de lan√ßamentos</li>
      </ul>
    </div>

    <div class="controls">
      <h2>üéÆ Testes B√°sicos</h2>
      <div class="button-grid">
        <button onclick="testHomepage()">üì∫ Teste Homepage</button>
        <button onclick="testSearch()">üîç Busca Simples</button>
        <button onclick="testSuggestions()">üí° Sugest√µes</button>
        <button onclick="testSchedule()">üìÖ Cronograma</button>
      </div>
    </div>

    <div class="controls">
      <h2>üé¨ Testes de Anime</h2>
      <div class="button-grid">
        <button onclick="testAnimeInfo('one-piece-100')">
          ‚ÑπÔ∏è One Piece Info
        </button>
        <button onclick="testAnimeInfo('naruto-shippuden')">
          ‚ÑπÔ∏è Naruto Info
        </button>
        <button onclick="testAnimeInfo('attack-on-titan-112')">
          ‚ÑπÔ∏è AOT Info
        </button>
        <button onclick="testAnimeInfoCustom()">‚ÑπÔ∏è Custom ID</button>
        <button onclick="testEpisodes('one-piece-100')">
          üìã One Piece EPs
        </button>
        <button onclick="testEpisodesCustom()">üìã Custom EPs</button>
      </div>
    </div>

    <div class="controls">
      <h2>üé≠ Testes por Categoria</h2>
      <div class="button-grid">
        <button onclick="testGenre('action')">‚öîÔ∏è Action</button>
        <button onclick="testGenre('adventure')">üó∫Ô∏è Adventure</button>
        <button onclick="testGenre('comedy')">üòÇ Comedy</button>
        <button onclick="testCategory('most-popular')">üî• Populares</button>
        <button onclick="testCategory('movie')">üé¨ Filmes</button>
      </div>
    </div>

    <div class="output-section">
      <h2>üìä Resultado</h2>
      <pre id="output">Clique em um bot√£o para iniciar os testes...</pre>
    </div>

    <script src="api-service.js"></script>
    <script>
      const apiStatus = document.getElementById("api-status");
      const output = document.getElementById("output");

      function setStatus(message, type) {
        apiStatus.textContent = message;
        apiStatus.className = `status ${type}`;
      }

      function setOutput(text, isError = false) {
        output.textContent = text;
        output.style.borderColor = isError ? "#ef4444" : "#334155";
      }

      // ===========================
      // TESTES B√ÅSICOS
      // ===========================

      async function testHomepage() {
        setOutput("‚è≥ Carregando homepage...");

        try {
          const startTime = performance.now();
          const data = await window.AnimeAPI.loadContentForHomepage();
          const endTime = performance.now();
          const duration = (endTime - startTime).toFixed(2);

          setOutput(
            `‚úÖ Homepage carregada em ${duration}ms\n\n` +
              `Se√ß√µes dispon√≠veis:\n` +
              `- Spotlight: ${data.spotlightAnimes?.length || 0} animes\n` +
              `- Trending: ${data.trendingAnimes?.length || 0} animes\n` +
              `- Popular: ${data.mostPopularAnimes?.length || 0} animes\n` +
              `- Favorites: ${data.mostFavoriteAnimes?.length || 0} animes\n` +
              `- Top 10: ${data.top10Animes?.length || 0} animes\n` +
              `- Airing: ${data.topAiringAnimes?.length || 0} animes\n` +
              `- Latest Episodes: ${
                data.latestEpisodeAnimes?.length || 0
              } animes\n` +
              `- Completed: ${
                data.latestCompletedAnimes?.length || 0
              } animes\n` +
              `- Upcoming: ${data.topUpcomingAnimes?.length || 0} animes\n\n` +
              `Dados completos:\n${JSON.stringify(data, null, 2)}`
          );

          console.log("‚úÖ Homepage data:", data);
        } catch (error) {
          setOutput(`‚ùå Erro: ${error.message}\n\n${error.stack}`, true);
          console.error(error);
        }
      }

      async function testSearch() {
        const query = prompt("Digite o nome do anime:", "naruto");
        if (!query) return;

        setOutput(`‚è≥ Buscando "${query}"...`);

        try {
          const startTime = performance.now();
          const data = await window.AnimeAPI.searchAnimes(query);
          const endTime = performance.now();
          const duration = (endTime - startTime).toFixed(2);

          setOutput(
            `‚úÖ Busca conclu√≠da em ${duration}ms\n` +
              `Resultados encontrados: ${data.animes?.length || 0}\n\n` +
              JSON.stringify(data, null, 2)
          );

          console.log("‚úÖ Search results:", data);
        } catch (error) {
          setOutput(`‚ùå Erro: ${error.message}\n\n${error.stack}`, true);
          console.error(error);
        }
      }

      async function testSuggestions() {
        const query = prompt("Digite para sugest√µes:", "one");
        if (!query) return;

        setOutput(`‚è≥ Buscando sugest√µes para "${query}"...`);

        try {
          const data = await window.AnimeAPI.getSearchSuggestions(query);
          setOutput(
            `‚úÖ Sugest√µes encontradas\n\n` + JSON.stringify(data, null, 2)
          );
          console.log("‚úÖ Suggestions:", data);
        } catch (error) {
          setOutput(`‚ùå Erro: ${error.message}\n\n${error.stack}`, true);
          console.error(error);
        }
      }

      async function testSchedule() {
        setOutput("‚è≥ Carregando cronograma...");

        try {
          const data = await window.AnimeAPI.getSchedule();
          setOutput(
            `‚úÖ Cronograma carregado\n\n` + JSON.stringify(data, null, 2)
          );
          console.log("‚úÖ Schedule:", data);
        } catch (error) {
          setOutput(`‚ùå Erro: ${error.message}\n\n${error.stack}`, true);
          console.error(error);
        }
      }

      // ===========================
      // TESTES DE ANIME
      // ===========================

      async function testAnimeInfo(id) {
        setOutput(`‚è≥ Carregando info de "${id}"...`);

        try {
          const startTime = performance.now();
          const data = await window.AnimeAPI.getAnimeInfo(id);
          const endTime = performance.now();
          const duration = (endTime - startTime).toFixed(2);

          const anime = data.anime?.info || data;

          setOutput(
            `‚úÖ Info carregada em ${duration}ms\n\n` +
              `Nome: ${anime.name || "N/A"}\n` +
              `Nome JP: ${anime.jname || "N/A"}\n` +
              `Rating: ${anime.rating || "N/A"}\n` +
              `Status: ${anime.stats?.status || "N/A"}\n` +
              `Epis√≥dios: ${anime.stats?.episodes?.sub || "N/A"}\n\n` +
              `Dados completos:\n${JSON.stringify(data, null, 2)}`
          );

          console.log("‚úÖ Anime info:", data);
        } catch (error) {
          setOutput(
            `‚ùå Erro: ${error.message}\n\n` +
              `ID usado: ${id}\n` +
              `Certifique-se de usar um ID v√°lido.\n\n` +
              `${error.stack}`,
            true
          );
          console.error(error);
        }
      }

      async function testAnimeInfoCustom() {
        const id = prompt("Digite o ID do anime:", "one-piece-100");
        if (!id) return;
        await testAnimeInfo(id);
      }

      async function testEpisodes(id) {
        setOutput(`‚è≥ Carregando epis√≥dios de "${id}"...`);

        try {
          const data = await window.AnimeAPI.getAnimeEpisodes(id);
          setOutput(
            `‚úÖ Epis√≥dios carregados\n` +
              `Total: ${data.episodes?.length || 0}\n\n` +
              JSON.stringify(data, null, 2)
          );
          console.log("‚úÖ Episodes:", data);
        } catch (error) {
          setOutput(`‚ùå Erro: ${error.message}\n\n${error.stack}`, true);
          console.error(error);
        }
      }

      async function testEpisodesCustom() {
        const id = prompt("Digite o ID do anime:", "one-piece-100");
        if (!id) return;
        await testEpisodes(id);
      }

      // ===========================
      // TESTES POR CATEGORIA
      // ===========================

      async function testGenre(genre) {
        setOutput(`‚è≥ Carregando g√™nero "${genre}"...`);

        try {
          const data = await window.AnimeAPI.getGenreAnimes(genre);
          setOutput(
            `‚úÖ Animes do g√™nero "${genre}"\n` +
              `Total: ${data.animes?.length || 0}\n\n` +
              JSON.stringify(data, null, 2)
          );
          console.log(`‚úÖ Genre ${genre}:`, data);
        } catch (error) {
          setOutput(`‚ùå Erro: ${error.message}\n\n${error.stack}`, true);
          console.error(error);
        }
      }

      async function testCategory(category) {
        setOutput(`‚è≥ Carregando categoria "${category}"...`);

        try {
          const data = await window.AnimeAPI.getCategoryAnimes(category);
          setOutput(
            `‚úÖ Animes da categoria "${category}"\n` +
              `Total: ${data.animes?.length || 0}\n\n` +
              JSON.stringify(data, null, 2)
          );
          console.log(`‚úÖ Category ${category}:`, data);
        } catch (error) {
          setOutput(`‚ùå Erro: ${error.message}\n\n${error.stack}`, true);
          console.error(error);
        }
      }

      // ===========================
      // VERIFICA√á√ÉO INICIAL
      // ===========================

      window.addEventListener("load", () => {
        setTimeout(() => {
          if (window.AnimeAPI) {
            console.log("‚úÖ API carregada com sucesso!");
            setStatus("‚úÖ API Pronta", "success");
            setOutput(
              "‚úÖ API carregada e pronta para testes!\n\n" +
                "Clique nos bot√µes acima para testar os endpoints.\n\n" +
                'Recomenda√ß√£o: Comece testando "üì∫ Teste Homepage"'
            );
          } else {
            console.error("‚ùå API n√£o foi carregada!");
            setStatus("‚ùå API n√£o carregada", "error");
            setOutput(
              "‚ùå Erro: API n√£o carregada!\n\nVerifique o console do navegador.",
              true
            );
          }
        }, 500);
      });
    </script>
  </body>
</html>
