<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Teste API - YayAnimes</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Courier New", monospace;
        background: #0f172a;
        color: white;
        padding: 20px;
        max-width: 1400px;
        margin: 0 auto;
      }

      h1 {
        text-align: center;
        margin-bottom: 30px;
        color: #667eea;
      }

      .status-bar {
        background: #1e293b;
        padding: 15px;
        border-radius: 8px;
        margin-bottom: 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .status {
        padding: 8px 16px;
        border-radius: 6px;
        font-weight: bold;
      }

      .status.success {
        background: #10b981;
        color: white;
      }
      .status.error {
        background: #ef4444;
        color: white;
      }
      .status.warning {
        background: #f59e0b;
        color: white;
      }
      .status.info {
        background: #3b82f6;
        color: white;
      }

      .controls {
        background: #1e293b;
        padding: 20px;
        border-radius: 8px;
        margin-bottom: 20px;
      }

      .controls h2 {
        margin-bottom: 15px;
        color: #667eea;
      }

      .button-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 10px;
      }

      button {
        background: #667eea;
        color: white;
        border: none;
        padding: 12px 20px;
        border-radius: 6px;
        cursor: pointer;
        font-size: 14px;
        font-weight: 600;
        transition: all 0.3s;
      }

      button:hover {
        background: #5568d3;
        transform: translateY(-2px);
      }

      button:active {
        transform: translateY(0);
      }

      .output-section {
        background: #1e293b;
        padding: 20px;
        border-radius: 8px;
      }

      .output-section h2 {
        margin-bottom: 15px;
        color: #667eea;
      }

      pre {
        background: #0f172a;
        padding: 15px;
        border-radius: 8px;
        overflow-x: auto;
        max-height: 600px;
        overflow-y: auto;
        font-size: 12px;
        line-height: 1.5;
        border: 2px solid #334155;
      }

      .endpoint-list {
        background: #1e293b;
        padding: 20px;
        border-radius: 8px;
        margin-bottom: 20px;
      }

      .endpoint-list h2 {
        margin-bottom: 15px;
        color: #667eea;
      }

      .endpoint-list ul {
        list-style: none;
      }

      .endpoint-list li {
        padding: 8px 0;
        border-bottom: 1px solid #334155;
        font-family: monospace;
        font-size: 13px;
        color: #9ca3af;
      }

      .endpoint-list li:last-child {
        border-bottom: none;
      }

      ::-webkit-scrollbar {
        width: 10px;
        height: 10px;
      }

      ::-webkit-scrollbar-track {
        background: #1e293b;
      }

      ::-webkit-scrollbar-thumb {
        background: #667eea;
        border-radius: 5px;
      }

      ::-webkit-scrollbar-thumb:hover {
        background: #5568d3;
      }
    </style>
  </head>
  <body>
    <h1>ğŸ§ª Teste da API YayAnimes</h1>

    <div class="status-bar">
      <div>
        <strong>Status da API:</strong>
        <span id="api-status" class="status warning">Verificando...</span>
      </div>
      <div>
        <strong>Base URL:</strong>
        <code style="color: #667eea"
          >https://yayapi-delta.vercel.app/api/v2/hianime</code
        >
      </div>
    </div>

    <div class="endpoint-list">
      <h2>ğŸ“‹ Endpoints DisponÃ­veis</h2>
      <ul>
        <li>âœ… /home - Homepage com todas as seÃ§Ãµes</li>
        <li>âœ… /search?q={query} - Busca de animes</li>
        <li>âœ… /search/suggestion?q={query} - SugestÃµes de busca</li>
        <li>âœ… /anime/{id} - InformaÃ§Ãµes do anime</li>
        <li>âœ… /anime/{id}/episodes - Lista de episÃ³dios</li>
        <li>
          âœ… /episode/servers?animeEpisodeId={id} - Servidores disponÃ­veis
        </li>
        <li>
          âœ…
          /episode/sources?animeEpisodeId={id}&server={server}&category={sub|dub|raw}
          - Links de streaming
        </li>
        <li>âœ… /genre/{name} - Animes por gÃªnero</li>
        <li>âœ… /category/{name} - Animes por categoria</li>
        <li>âœ… /schedule - Cronograma de lanÃ§amentos</li>
      </ul>
    </div>

    <div class="controls">
      <h2>ğŸ® Testes BÃ¡sicos</h2>
      <div class="button-grid">
        <button onclick="testHomepage()">ğŸ“º Teste Homepage</button>
        <button onclick="testSearch()">ğŸ” Busca Simples</button>
        <button onclick="testSuggestions()">ğŸ’¡ SugestÃµes</button>
        <button onclick="testSchedule()">ğŸ“… Cronograma</button>
      </div>
    </div>

    <div class="controls">
      <h2>ğŸ¬ Testes de Anime</h2>
      <div class="button-grid">
        <button onclick="testAnimeInfo('one-piece-100')">
          â„¹ï¸ One Piece Info
        </button>
        <button onclick="testAnimeInfo('naruto-shippuden')">
          â„¹ï¸ Naruto Info
        </button>
        <button onclick="testAnimeInfo('attack-on-titan-112')">
          â„¹ï¸ AOT Info
        </button>
        <button onclick="testAnimeInfoCustom()">â„¹ï¸ Custom ID</button>
        <button onclick="testEpisodes('one-piece-100')">
          ğŸ“‹ One Piece EPs
        </button>
        <button onclick="testEpisodesCustom()">ğŸ“‹ Custom EPs</button>
      </div>
    </div>

    <div class="controls">
      <h2>ğŸ­ Testes por Categoria</h2>
      <div class="button-grid">
        <button onclick="testGenre('action')">âš”ï¸ Action</button>
        <button onclick="testGenre('adventure')">ğŸ—ºï¸ Adventure</button>
        <button onclick="testGenre('comedy')">ğŸ˜‚ Comedy</button>
        <button onclick="testCategory('most-popular')">ğŸ”¥ Populares</button>
        <button onclick="testCategory('movie')">ğŸ¬ Filmes</button>
      </div>
    </div>

    <div class="output-section">
      <h2>ğŸ“Š Resultado</h2>
      <pre id="output">Clique em um botÃ£o para iniciar os testes...</pre>
    </div>

    <script src="api-service.js"></script>
    <script>
      const apiStatus = document.getElementById("api-status");
      const output = document.getElementById("output");

      function setStatus(message, type) {
        apiStatus.textContent = message;
        apiStatus.className = `status ${type}`;
      }

      function setOutput(text, isError = false) {
        output.textContent = text;
        output.style.borderColor = isError ? "#ef4444" : "#334155";
      }

      // ===========================
      // TESTES BÃSICOS
      // ===========================

      async function testHomepage() {
        setOutput("â³ Carregando homepage...");

        try {
          const startTime = performance.now();
          const data = await window.AnimeAPI.loadContentForHomepage();
          const endTime = performance.now();
          const duration = (endTime - startTime).toFixed(2);

          setOutput(
            `âœ… Homepage carregada em ${duration}ms\n\n` +
              `SeÃ§Ãµes disponÃ­veis:\n` +
              `- Spotlight: ${data.spotlightAnimes?.length || 0} animes\n` +
              `- Trending: ${data.trendingAnimes?.length || 0} animes\n` +
              `- Popular: ${data.mostPopularAnimes?.length || 0} animes\n` +
              `- Favorites: ${data.mostFavoriteAnimes?.length || 0} animes\n` +
              `- Top 10: ${data.top10Animes?.length || 0} animes\n` +
              `- Airing: ${data.topAiringAnimes?.length || 0} animes\n` +
              `- Latest Episodes: ${
                data.latestEpisodeAnimes?.length || 0
              } animes\n` +
              `- Completed: ${
                data.latestCompletedAnimes?.length || 0
              } animes\n` +
              `- Upcoming: ${data.topUpcomingAnimes?.length || 0} animes\n\n` +
              `Dados completos:\n${JSON.stringify(data, null, 2)}`
          );

          console.log("âœ… Homepage data:", data);
        } catch (error) {
          setOutput(`âŒ Erro: ${error.message}\n\n${error.stack}`, true);
          console.error(error);
        }
      }

      async function testSearch() {
        const query = prompt("Digite o nome do anime:", "naruto");
        if (!query) return;

        setOutput(`â³ Buscando "${query}"...`);

        try {
          const startTime = performance.now();
          const data = await window.AnimeAPI.searchAnimes(query);
          const endTime = performance.now();
          const duration = (endTime - startTime).toFixed(2);

          setOutput(
            `âœ… Busca concluÃ­da em ${duration}ms\n` +
              `Resultados encontrados: ${data.animes?.length || 0}\n\n` +
              JSON.stringify(data, null, 2)
          );

          console.log("âœ… Search results:", data);
        } catch (error) {
          setOutput(`âŒ Erro: ${error.message}\n\n${error.stack}`, true);
          console.error(error);
        }
      }

      async function testSuggestions() {
        const query = prompt("Digite para sugestÃµes:", "one");
        if (!query) return;

        setOutput(`â³ Buscando sugestÃµes para "${query}"...`);

        try {
          const data = await window.AnimeAPI.getSearchSuggestions(query);
          setOutput(
            `âœ… SugestÃµes encontradas\n\n` + JSON.stringify(data, null, 2)
          );
          console.log("âœ… Suggestions:", data);
        } catch (error) {
          setOutput(`âŒ Erro: ${error.message}\n\n${error.stack}`, true);
          console.error(error);
        }
      }

      async function testSchedule() {
        setOutput("â³ Carregando cronograma...");

        try {
          const data = await window.AnimeAPI.getSchedule();
          setOutput(
            `âœ… Cronograma carregado\n\n` + JSON.stringify(data, null, 2)
          );
          console.log("âœ… Schedule:", data);
        } catch (error) {
          setOutput(`âŒ Erro: ${error.message}\n\n${error.stack}`, true);
          console.error(error);
        }
      }

      // ===========================
      // TESTES DE ANIME
      // ===========================

      async function testAnimeInfo(id) {
        setOutput(`â³ Carregando info de "${id}"...`);

        try {
          const startTime = performance.now();
          const data = await window.AnimeAPI.getAnimeInfo(id);
          const endTime = performance.now();
          const duration = (endTime - startTime).toFixed(2);

          const anime = data.anime?.info || data;

          setOutput(
            `âœ… Info carregada em ${duration}ms\n\n` +
              `Nome: ${anime.name || "N/A"}\n` +
              `Nome JP: ${anime.jname || "N/A"}\n` +
              `Rating: ${anime.rating || "N/A"}\n` +
              `Status: ${anime.stats?.status || "N/A"}\n` +
              `EpisÃ³dios: ${anime.stats?.episodes?.sub || "N/A"}\n\n` +
              `Dados completos:\n${JSON.stringify(data, null, 2)}`
          );

          console.log("âœ… Anime info:", data);
        } catch (error) {
          setOutput(
            `âŒ Erro: ${error.message}\n\n` +
              `ID usado: ${id}\n` +
              `Certifique-se de usar um ID vÃ¡lido.\n\n` +
              `${error.stack}`,
            true
          );
          console.error(error);
        }
      }

      async function testAnimeInfoCustom() {
        const id = prompt("Digite o ID do anime:", "one-piece-100");
        if (!id) return;
        await testAnimeInfo(id);
      }

      async function testEpisodes(id) {
        setOutput(`â³ Carregando episÃ³dios de "${id}"...`);

        try {
          const data = await window.AnimeAPI.getAnimeEpisodes(id);
          setOutput(
            `âœ… EpisÃ³dios carregados\n` +
              `Total: ${data.episodes?.length || 0}\n\n` +
              JSON.stringify(data, null, 2)
          );
          console.log("âœ… Episodes:", data);
        } catch (error) {
          setOutput(`âŒ Erro: ${error.message}\n\n${error.stack}`, true);
          console.error(error);
        }
      }

      async function testEpisodesCustom() {
        const id = prompt("Digite o ID do anime:", "one-piece-100");
        if (!id) return;
        await testEpisodes(id);
      }

      // ===========================
      // TESTES POR CATEGORIA
      // ===========================

      async function testGenre(genre) {
        setOutput(`â³ Carregando gÃªnero "${genre}"...`);

        try {
          const data = await window.AnimeAPI.getGenreAnimes(genre);
          setOutput(
            `âœ… Animes do gÃªnero "${genre}"\n` +
              `Total: ${data.animes?.length || 0}\n\n` +
              JSON.stringify(data, null, 2)
          );
          console.log(`âœ… Genre ${genre}:`, data);
        } catch (error) {
          setOutput(`âŒ Erro: ${error.message}\n\n${error.stack}`, true);
          console.error(error);
        }
      }

      async function testCategory(category) {
        setOutput(`â³ Carregando categoria "${category}"...`);

        try {
          const data = await window.AnimeAPI.getCategoryAnimes(category);
          setOutput(
            `âœ… Animes da categoria "${category}"\n` +
              `Total: ${data.animes?.length || 0}\n\n` +
              JSON.stringify(data, null, 2)
          );
          console.log(`âœ… Category ${category}:`, data);
        } catch (error) {
          setOutput(`âŒ Erro: ${error.message}\n\n${error.stack}`, true);
          console.error(error);
        }
      }

      // ===========================
      // VERIFICAÃ‡ÃƒO INICIAL
      // ===========================

      window.addEventListener("load", () => {
        setTimeout(() => {
          if (window.AnimeAPI) {
            console.log("âœ… API carregada com sucesso!");
            setStatus("âœ… API Pronta", "success");
            setOutput(
              "âœ… API carregada e pronta para testes!\n\n" +
                "Clique nos botÃµes acima para testar os endpoints.\n\n" +
                'RecomendaÃ§Ã£o: Comece testando "ğŸ“º Teste Homepage"'
            );
          } else {
            console.error("âŒ API nÃ£o foi carregada!");
            setStatus("âŒ API nÃ£o carregada", "error");
            setOutput(
              "âŒ Erro: API nÃ£o carregada!\n\nVerifique o console do navegador.",
              true
            );
          }
        }, 500);
      });
    </script>
  </body>
</html>
